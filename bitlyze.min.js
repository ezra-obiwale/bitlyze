(function(t){t.fn.bitlyze=function(e){var a={},l=localStorage.getItem("btz");l&&(a=JSON.parse(l));var r={bitlyUrl:"https://api-ssl.bitly.com/v3/shorten",accessToken:"",urlDataKey:"url",callback:function(t){}};return t.extend(r,e),this.each(function(){var e=t(this),l=e.data(r.urlDataKey);if(a[l])return void(a[l].short?e.addClass("bitlyzed").data("url",a[l].short):a[l].queue.push(this));a[l]={queue:[this]};var s=r.bitlyUrl;s+=s.indexOf("?")===-1?"?":"&",s+="format=txt",s+="&access_token="+r.accessToken,s+="&longUrl="+encodeURIComponent(l),t.get(s,function(e){a[l].short=e;for(var s=0;s<a[l].queue.length;s++)t(a[l].queue[s]).addClass("bitlyzed").data(r.urlDataKey,e),r.callback.call(a[l].queue[s],e);a[l].queue=[],localStorage.setItem("btz",JSON.stringify(a))})}),this}})(jQuery);